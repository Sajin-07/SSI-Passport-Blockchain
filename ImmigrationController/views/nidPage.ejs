<!DOCTYPE html>
<html lang="en" data-theme="fantasy">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
		<!-- Tailwind CSS and daisyUI -->
		<link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
		<link href="https://cdn.jsdelivr.net/npm/daisyui@2.0.0/dist/full.css" rel="stylesheet">
		<title>Document</title>
	</head>
	<body>

		<nav class="bg-base-200 shadow">
			<div class="container mx-auto px-4 py-4 flex items-center justify-between">
				<a class="text-xl font-bold" href="#">Immigration Center</a>
				<div class="flex items-center gap-4">
					<label class="flex cursor-pointer gap-2 items-center">
						<!-- Sun Icon -->
						<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
							<circle cx="12" cy="12" r="5" />
							<path d="M12 1v2M12 21v2M4.2 4.2l1.4 1.4M18.4 18.4l1.4 1.4M1 12h2M21 12h2M4.2 19.8l1.4-1.4M18.4 5.6l1.4-1.4" />
						</svg>
						<!-- Toggle Switch -->
						<input type="checkbox" class="toggle theme-controller" />
						<!-- Moon Icon -->
						<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
							<path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
						</svg>
					</label>
				</div>
				<button class="lg:hidden text-gray-500">
					<span class="iconify" data-icon="heroicons-outline:menu-alt-4"></span>
				</button>
				<div class="hidden lg:flex space-x-4">
					<a href="/" class="bg-green-500 text-white py-2 px-4 rounded font-bold hover:bg-green-600">Home</a>
					<!-- Additional Links can be added here -->
				</div>
			</div>
		</nav>
       

		<div class="container mx-auto px-4 py-10">
			<h2 class="text-xl font-bold mb-4">NID Verification</h2>
			<form action="/api/check-nid" method="GET">
				<label for="nid" class="block mb-2 text-sm font-medium">Enter your NID number:</label>
				<input
					type="number"
					id="nid"
					name="nid"
					maxlength="10"
					class="input input-bordered w-full mb-4"
					placeholder="Enter 10-digit NID number"
					required
					pattern="\d{10}"
				/>
				<button id="submit" class="btn btn-primary w-full">Submit</button>
			</form>
			<br>
			<!-- <a href="/visaApplyOrClaim" class="btn btn-primary w-full">Next</a> -->

		</div>
		


        <% if (typeof message !== 'undefined') { %>
			<script>
				alert("<%= message %>");
			</script>
		<% } %>
        <script>
			// JavaScript for Theme Toggle
			document.addEventListener('DOMContentLoaded', function () {
				const themeController = document.querySelector('.theme-controller');
				
				// Check stored theme or default to light (bumblebee)
				const currentTheme = localStorage.getItem('theme') || 'fantasy';
				document.documentElement.setAttribute('data-theme', currentTheme);
				themeController.checked = currentTheme === 'synthwave';

				// Toggle event listener
				themeController.addEventListener('change', function () {
					const theme = themeController.checked ? 'synthwave' : 'fantasy';
					document.documentElement.setAttribute('data-theme', theme);
					localStorage.setItem('theme', theme);
				});
			});
		
			document.querySelector('#submit').addEventListener('click', async function (e) {
				e.preventDefault(); // Prevent the form from submitting normally

				const nidInput = document.querySelector('#nid');
				const nid = nidInput.value;

				if (!nid) {
					alert('Please enter a valid NID number!');
					return;
				}

				try {
					// Make a GET request to the server using Fetch API
					const response = await fetch(`/api/check-nid?nid=${nid}`);
					const result = await response.json();

					if (response.status === 200 && result.matched) {
						// Show alert and redirect if the NID matches
						if (confirm(result.message)) {
							window.location.href = '/connectImmigration'; 
						}
					} else {
						// Show alert if the NID does not match
						alert(result.message);
					}
				} catch (error) {
					console.error('Error:', error);
					alert('An error occurred. Please try again later.');
				}
			});

			

		</script>


	</body>
</html>

